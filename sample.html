<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
  <script>
    var idList = ["Canvas", "Canvastext", "Buttontext", "Buttonface", "Selecteditem", "Selecteditemtext", "Linktext", "Visitedtext"];

      function createElements() {
        idList.forEach((id) => {
          var label = document.createElement("label");
          label.id = id;
          label.innerHTML = id;
          label.for = id.concat("input");
          document.body.appendChild(label);

          var colorInput = document.createElement("input");
          colorInput.type = "color";
          colorInput.id = id.concat("input");
          document.body.appendChild(colorInput);

          document.body.appendChild(document.createElement("br"));
        });
        setColors();
      }

      function byteToHex(num) {
        // Turns a number (0-255) into a 2-character hex number (00-ff)
        return ('0' + num.toString(16)).slice(-2);
      }

      function setColors() {
        idList.forEach((id) => {
          var elm = document.getElementById(id);
          elm.style.color = id;
          var rgbVal = window.getComputedStyle(elm).getPropertyValue("color");
          var rgba = rgbVal.slice(4, -1).split(", ").map(e => parseInt(e));
          var hexValue = [0, 1, 2].map(
            function (idx) { return byteToHex(rgba[idx]); }
          ).join('');
          console.log(id + ": #" + hexValue);
          document.getElementById(id.concat("input")).value = "#".concat(hexValue);
          elm.style.color = "Canvastext";
        })
      }



      window.onload = createElements;
  </script>
</head>
<body>
</body>
</html>
